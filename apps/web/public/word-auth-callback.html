<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Word Auth Callback</title>
    <script
      type="text/javascript"
      src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"
    ></script>
    <style>
      body {
        display: flex;
        align-items: center;
        justify-content: center;
        height: 100vh;
        margin: 0;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto",
          "Oxygen", "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans",
          "Helvetica Neue", sans-serif;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        background-color: #f0f0f0;
      }
      #status {
        padding: 20px;
        border-radius: 8px;
        background-color: white;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        text-align: center;
      }
      .success {
        color: #28a745;
      }
      .error {
        color: #dc3545;
      }
    </style>
  </head>
  <body>
    <div id="status">Initializing...</div>

    <script type="text/javascript">
      // The recommended initialization function for Office dialogs
      Office.initialize = function () {
        const statusEl = document.getElementById("status");
        statusEl.textContent = "Searching for authentication token...";

        // Use the URL hash to get the token
        const urlParams = new URLSearchParams(
          window.location.hash.substring(1)
        );
        const accessToken = urlParams.get("access_token");

        if (accessToken) {
          statusEl.textContent = "Token found. Sending to add-in...";
          // Send the token to the parent task pane
          Office.context.ui.messageParent(accessToken, {
            targetOrigin: "https://localhost:3000",
          });
          statusEl.innerHTML =
            '<span class="success">Success! You can close this window.</span>';
        } else {
          statusEl.textContent = "Error: No access token found in the URL.";
          Office.context.ui.messageParent("error:no_token", {
            targetOrigin: "https://localhost:3000",
          });
          statusEl.innerHTML =
            '<span class="error">Authentication failed. Please try again.</span>';
        }
      };
    </script>
  </body>
</html>
